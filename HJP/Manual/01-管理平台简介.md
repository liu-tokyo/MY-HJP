


<h1>管理平台简介</h1>

---
<h2>目录</h2>

- [1、文件列表](#1文件列表)
- [2、环境初始化](#2环境初始化)
  - [2.1 管理平台环境初始化](#21-管理平台环境初始化)
  - [2.2 服务器端软件保存位置初始化](#22-服务器端软件保存位置初始化)
  - [2.3 输出数据保存目录初始化](#23-输出数据保存目录初始化)
  - [2.4 服务器端软件布置](#24-服务器端软件布置)

---

通过平台对货检系统的部署、维护等进行管理。需要管理者权限进行正确设置。
- 不再通过直接界面操作进行系统部署、维护等操作；
- 通过管理平台开发，针对货检系统的安全（防止泄密）也是一次完善。

※ 管理平台属于最后才开发的工具，处于逐步完善阶段。相关人员通过对管理平台的应用，逐步提出合理化建议，然后逐步完善。

※ 后续：考虑通过SSH方式远端登录服务器，通过指令对机房内的服务器进行维护、管理等操作；尽量减少必须进入机房作业的可能。

## 1、文件列表

- 管理平台文件列表：

  | No.  | 文件名称     | 说明                                 |
  | :--: | ------------ | ------------------------------------ |
  |  1   | hCloud.exe   | 主控模块                             |
  |  2   | hStarter.dll | 开机自动启动管理模块                 |
  |  3   | init.dll     | 管理平台初始化处理模块               |
  |  4   | output.dll   | 数据输出管理模块                     |
  |  4   | project.dll  | 当前工程管理模块                     |
  |  5   | projects.dll | 工程集群管理模块                     |
  |  6   | repo.dll     | 铁路货检系统服务器端软件仓库管理模块 |

## 2、环境初始化

- 假定如下环境条件：

  | No.  | 环境说明                 | 文件目录      | 备注                                                 |
  | :--: | ------------------------ | ------------- | ---------------------------------------------------- |
  |  1   | 货检管理平台软件保存目录 | `D:\HCloud`   | 本平台文件放置目录。                                 |
  |  2   | 货检服务器端软件保存目录 | `D:\~Storage` | 该目录设置为系统目录，针对普通用户，属于不可见状态。 |
  |  3   | 输出数据保存目录         | `D:\HJ_DATA`  | 所有处理的结果数据保存到该目录，可以方便查询。       |

### 2.1 管理平台环境初始化

- 把管理平台的相关文件拷贝到`D:\HCloud`目录中，然后启动`CMD`命令行，执行如下指令：

  ```sh
  hcloud init
  ```

**主要功能简介：**

- 确定所有指令执行的位置；
- 随后在任何命令行中输入`hcloud`指令之后，都会跳转到`D:\HCloud`目录中；
- 设置服务器端软件随着`OS`启动，自动启动。
  - 放弃原有的把`CPS_Lanucher.exe`的快捷方式，拷贝到自动启动目录的方式。
  - 放弃必须`Windows`系统设置自动登录的方式，在未登录状态就可以保证货检服务器端软件正常运行。

※ 管理平台的管理属于不加密管理，随后会有相应的安全措施加入。

※ 一旦管理平台的文件放置目录发生改变，都要执行该指令。

### 2.2 服务器端软件仓库管理

- 从指定路径，把服务器端软件导入软件仓库，执行如下指令：

  ```sh
  hcloud repo init -dir="D:\HKS"
  ```

  ※ `D:\HKS`目录为放置了货检系统可执行文件的目录，上述指令把软件导入到货检仓库中。

- 清除软件仓库的所有内容，执行如下指令：

  ```shell
  hcloud repo remove
  ```

  删除内容包括软件各个过程的部分、已经软件仓库的基础部分，删除内容无法恢复。

  如果想要恢复，需要重新对软件仓库进行初始化、以及仓库工程重新构筑。

- 从软件仓库配置XML，自动构筑软件仓库中的所有内容，执行如下指令：

  ```shell
  hcloud repo build -xml="D:\hks.xml"
  ```

  从"`D:\hks.xml`"文件读入所有过程的配置，自动创建所需工程。该指令一般在软件仓库初始化之后执行。

  具体该XML文件的格式，请参照相关文档。

- 软件仓库的软件升级，请执行如下指令：

  ```shell
  hcloud repo update -dir="D:\HKS"
  ```

  ※ "D:\HKS"目录放置需要升级的软件模块，软件升级需要确保所有工程 都处于停止状态，否则升级过程中会出现错误。

- 如下指令查询设置信息：

  ```sh
  hcloud repo show
  ```

  ※ 该指令需要特殊权限进行设置，后续会追加安全管理措施（尽量不允许普通的用户查看到该信息）。

### 2.3 输出数据保存目录初始化

- 执行如下指令：

  ```sh
  hcloud output config -dir="D:\HJ_DATA"
  ```

  ※ 后续版本会把所有的数据输出保存到该目录，如果所有工程都在同一电脑的话，就不再需要FTP上传功能。

- 如下指令查询设置信息：

  ```sh
  hcloud output show
  ```

### 2.4 服务器端软件布置 - 已经删除

- 把相关文件拷贝到如下目录中（**已经废弃该方式**）：
  - D:\~Storage\PRJ_000

  ※ 后续会通过专门的打包方式，进行初始文件的发布。

  ※ 关于每个工程的发布方式，在下一节的`02-工程集群管理`篇章进行介绍。





